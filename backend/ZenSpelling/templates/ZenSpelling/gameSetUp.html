{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Game Set Up Student</title>
    <script src={% static 'ZenSpelling/js/gameSetUp.js' %}></script>
    <script src={% static 'ZenSpelling/js/twinkle.js' %} defer></script>
    <link rel="stylesheet" href="{% static 'ZenSpelling/game-setup-style.css' %}">
    <link rel="stylesheet" href="{% static 'ZenSpelling/twinkle.css' %}">
    <script src = {% static 'Resources/jquery3.7.1.js'  %}></script> 
</head>
<body>
    <div class="center">
        <button id="mute_play"> Turn Music ON </button>
        <button class="logoutButton" onclick="logout()">Log Out</button>
        <h1>Choose Board Size and Question Set</h1>
        <br>
        <div class = "buttons-container">
            <ul class = "listOfSets">
            {% for question_set in question_sets %}
                <li class = "questionSets">
{#                <button id = "sets" class = "data-question-set-id={{ question_set.id }}" onclick="changeColor(this)">#}
{#                     {{question_set}}#}
{#               </button>#}
                {% for question_set in question_sets %}
                <a href="#" class="question-set" data-question-set-id="{{ question_set.id }}">{{ question_set.name }}</a>
                {% endfor %}
                </li>
            {% endfor %}
            </ul>
    </div>
        <div class="item-center">
            <ul>
                <li> <div class = "text"> 3x3</div> <button onclick="playGame(3)"><img alt="3x3grid" height = 250em width = 250em src={% static 'ZenSpelling/images/myCanvas-3.png' %}/></button></li>
                <li> <div class = "text"> 4x4</div> <button onclick="playGame(4)"><img alt="4x4grid" height = 250em width = 250em src={% static 'ZenSpelling/images/myCanvas-4.png' %}/></button></li>
                <li> <div class = "text"> 5x5</div> <button onclick="playGame(5)"><img alt="5x5grid" height = 250em width = 250em src={% static 'ZenSpelling/images/myCanvas-5.png' %}/></button></li>
            </ul>
        </div>
    </div>
    <div id="twinkling-container">
        <div class = "twinkling-pixel"> </div>
    </div>

<audio id = "background-music" loop>
        <source src="{% static 'Resources/Music/calm.mp3' %}" type="audio/mp3">
        No browser support
    </audio>

<script> <!-- move this -->
    document.getElementById("mute_play").onclick = function() {
      let audio = document.getElementById("background-music");
      
      if(audio.paused) {
          audio.play();
          this.textContent = "Turn Music OFF";
      }
      else {
          audio.pause();
          this.textContent = "Turn Music ON";
      }
  }
  
  function playMusic() {
            // Your code to start playing the music
            // Store the state of the music player in session storage
            sessionStorage.setItem('musicPlaying', 'true');
        }
        // Function to check if the music should be playing
        function checkMusic() {
            let musicPlaying = sessionStorage.getItem('musicPlaying');
            if (musicPlaying === 'true') {
                // Your code to resume playing the music
                // For demonstration purposes, let's just log a message
            }
        }
  window.onload = checkMusic;

    let prevButton = null;

function changeColor(button) {
    let buttons = document.querySelectorAll('.sets');
    buttons.forEach(function(btn) {
        if (btn !== button) {
            // Reset background color and text color of all buttons except the clicked one
            btn.style.backgroundColor = '';
            btn.style.color = '';
        }
    });
    
    // If a previously selected button exists, reset its styles
    if (prevButton !== null && prevButton !== button) {
        prevButton.style.backgroundColor = '';
        prevButton.style.color = '';
    }
    
    // Set the clicked button's styles
    button.style.backgroundColor = 'greenyellow';
    button.style.color = 'black';
    
    // Update the previously selected button
    prevButton = button;
    
$(document).ready(function() {
    $('.question-set').click(function(event) {
        event.preventDefault(); // Prevent the default behavior of the link
        
        let questionSetId = $(this).data('question-set-id');
        
        // Make an AJAX request to retrieve questions for this question set
        fetch('/generate_questions/?question_set_id=' + questionSetId)
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                
                // Handle the response containing the questions
                let questions = data.questions;
                let sidelength = data.sidelength;

                // Now you can use the retrieved questions and sidelength as needed
                console.log('Questions:', questions);
                console.log('Sidelength:', sidelength);

                // Continue with your logic, such as displaying the questions on the page
            })
            .catch(error => {
                console.error('Error:', error);
            });
    });
});
    }
</script>
</body>
</html>